<!DOCTYPE html>

	<head>
	  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
   

   

      

   <title>Calculator</title>

      <meta name="description" content="Simple calculator with HTML, CSS and JS">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta property="og:title" content="Calculator">
      <meta property="og:description" content="Simple calculator with HTML, CSS and JS">
      <meta property="og:url" content="https://enlight.ml/calculator">
      <meta property="og:image" content="https://enlight.ml/enlight-logo.png" /> 
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@tryenlight" />
      <meta name="twitter:title" content="Calculator" />
      <meta name="twitter:description" content="Simple calculator with HTML, CSS and JS" />
      <meta name="twitter:image" content="https://enlight.ml/enlight-logo.png" />

      <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/tachyons/4.7.0/tachyons.min.css" />
      <link href="/style.css" rel="stylesheet">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.css" />

      <script>
         (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
         (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
         m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
         
         ga('create', 'UA-85620206-1', 'auto');
         ga('send', 'pageview');
      </script>
	</head>


	<header>
	<nav class="db dt-l tc tl-l w-100 border-box pa3 ph5-l ba b--black-10 ">
  <div class="gradient">
    <a class="f2 fw3 dib pa2 no-underline black" href="/">
		Enlight
    </a>
  </div>
  <div class="db dtc-l v-mid w-100 w-75-l tc tr-l fw5">
    <a class="link f5 dib mr3 mr4-l black hover-blue" href="/#projects">Projects</a>
    <a class="link f5 dib mr3 mr4-l black hover-blue" href="/web">JavaScript</a>
    <a class="link f5 dib mr3 mr4-l black hover-blue" href="/python">Python</a>
    <a class="link f5 dib mr3 mr4-l black hover-blue" href="/swift">Swift</a>
    <a class="link f5 dib mr3 mr4-l black hover-blue" href="https://github.com/samayshamdasani/enlight#contribute-by-adding-your-projects--tutorials">Contribute</a>
    <a class="link f5 dib mr3 mr4-l black hover-blue" href="/about">About</a>
  </div>
</nav>
	</header>


	<body>

	 <article class="vh-100 dt w-100 project-purple tc">
<div class="mw5 mw6-ns center pt4">
  <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=enlightml" id="_carbonads_js"></script>

</div>
  <div class="dtc v-mid tc white ph3 ph4-l">
    <h1 class="f1 f-subheadline-l fw6 tc">Build a <span class="underline">Calculator</span></h1>
    <a href="/demo/calculator-project/index.html"><img class="project-image" src="/img/calc.gif"></a><br><br>
    <a href="https://github.com/samayshamdasani/enlight/tree/gh-pages/demo/calculator-project" class="f4 link dim ba ph3 pv2 mb2 dib white">Source</a>
    <a href="/demo/calculator-project/index.html" class="f4 link dim ba ph3 pv2 mb2 dib white">Demo</a>
  </div>
</article>

<div class="center measure-wide f4 pv5 lh-copy ph2 content">
  <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false" data-size="large">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

  <h3 id="getting-started">Getting Started</h3>

<p>This calculator app is based on a design over at <a href="https://dribbble.com/shots/3125651-Daily-UI-004-Calculator" class="underline">dribble</a>. We have made a few minor changes to the original design, but you are always welcome to tinker and improve this app. It’s file structure includes</p>
<ul>
  <li>index.html (markup)</li>
  <li>style.css (styling)</li>
  <li>app.js (calculator functions)</li>
</ul>

<h3 id="the-markup">The Markup</h3>

<p>In the markup, we have a div with class <code class="highlighter-rouge">calc</code>, that is our calculator. It has two child elements, a div classed <code class="highlighter-rouge">results</code> and a div classed <code class="highlighter-rouge">keypad</code>. As the name suggests, results is the place where results are displayed and keypad is calculator’s keypad. If you peek inside, you could see that keypad is divided into <code class="highlighter-rouge">row</code>s and each button has some <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/data-*" class="underline">data-attributes</a>. Custom data attributes are intended to store custom data private to the page or application, for which there are no more appropriate attributes or elements.</p>

<pre class="prettyprint"><xmp>
  <button class="key" data-value="7" data-action="number">7</button>
 </xmp></pre>

<p>The attribute <code class="highlighter-rouge">data-value</code> stores the value of button and <code class="highlighter-rouge">data-action</code> ditactes what action is to be perfomed if we click it.</p>

<p>Here’s what the markup looks like:</p>
<pre class="prettyprint"><xmp>
 <html lang="en">
 <head>
  <meta charset="UTF-8" />
  <title>Calculator</title>
  <link rel="stylesheet" href="style.css" />
 </head>
 <body id="calc">
  <div class="wrap">
    <div class="calc">
      <div class="results">
        <div class="accum">
          <p id="num-a"></p>
          <p id="operator"></p>
          <p id="num-b"></p>
        </div>
        <p class="res" id="result"></p>
      </div>
      <div class="keypad">
        <div class="row">
          <button class="key" data-value="7" data-action="number">7</button>
          <button class="key" data-value="8" data-action="number">8</button>
          <button class="key" data-value="9" data-action="number">9</button>
          <button class="key" data-value="+" data-action="operation">+</button>
        </div>
        <div class="row">
          <button class="key" data-value="4" data-action="number">4</button>
          <button class="key" data-value="5" data-action="number">5</button>
          <button class="key" data-value="6" data-action="number">6</button>
          <button class="key" data-value="-" data-action="operation">-</button>
        </div>
        <div class="row">
          <button class="key" data-value="1" data-action="number">1</button>
          <button class="key" data-value="2" data-action="number">2</button>
          <button class="key" data-value="3" data-action="number">3</button>
          <button class="key" data-value="*" data-action="operation">*</button>
        </div>
        <div class="row">
          <button class="key" data-value="0" data-action="number">0</button>
          <button class="key" data-value="c" data-action="operation">c</button>
          <button class="key" data-value="/" data-action="operation">/</button>
          <button class="key" data-value="=" data-action="calculate">=</button>
        </div>
      </div>
    </div>
  </div>
  <script src="app.js"></script>
 </body>
 </html>
</xmp></pre>

<h3 id="the-styling">The Styling</h3>

<p>CSS for calculator project is defined in the file <code class="highlighter-rouge">style.css</code>. Apart from what you have seen on other tutorials, there are three things that might interest you in here</p>

<ol>
  <li><code class="highlighter-rouge">@import url('https://fonts.googleapis.com/css?family=Roboto');</code> We are importing a custom font into our project here, to learn more about importing custom fonts, checkout this<a href="https://fonts.google.com/" class="underline">link</a>. We have used <code class="highlighter-rouge">@import</code> to import the font, the @import CSS at-rule is used to import style rules from other style sheets <a href="http://www.cssnewbie.com/css-import-rule/#.WKcWjSF948o">Read more</a>.</li>
  <li><code class="highlighter-rouge">display: flex;</code> Flexbox is a new display type introduced in CSS3, it is very handy in implementing layouts intuitively. A tutorial on flexbox can take up a lot of space, go over to <a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/">CSS-Tricks</a>, read this in deapth tutorial and gain knowledge on CSS flexbox.</li>
  <li><code class="highlighter-rouge">.results &gt; *</code> <code class="highlighter-rouge">.key:hover</code>, these are some advanced CSS selectors, <code class="highlighter-rouge">&gt;</code> is a child selector, this means “select elements that are direct descendants of elements with class results”. <code class="highlighter-rouge">:hover</code> is a CSS psuedo selector, which means to apply a style when an element is in hovered state. Read the CSS selector <a href="https://css-tricks.com/almanac/selectors/">almanac</a> here.</li>
</ol>

<p>Here’s our styling:</p>
<pre class="prettyprint">
  @import url('https://fonts.googleapis.com/css?family=Roboto');

  #calc {
    align-items: center;
    background-color: #A25BCD;
    display: flex;
    height: 95vh;
    justify-content: center;
  }

  .results {
    box-sizing: border-box;
    height: 220px;
    padding: 20px 20px;
  }

  .wrap {
    background-color: #4F31B5;
    border-radius: 20px;
    box-shadow: 0px 1px 5px 0px rgba(0,0,0,0.75);
    height: 560px;
    width: 360px;
    position: relative;
  }

  .row {
    display: flex;
    justify-content: space-between;
    padding: 10px 20px;
  }

  .key {
    background-color: #4F31B5;
    border: 2px solid #C3B2E4;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: inline-block;
    font-family: 'Roboto', sans-serif;
    font-size: 14px;
    font-weight: bold;
    height: 60px;
    line-height: 60px;
    text-align: center;
    width: 60px;
  }

  .key:hover {
    box-shadow: 0px 1px 5px 0px rgba(0,0,0,0.75);
  }
  .key:focus {
    outline: none;
  }

  .results &gt; * {
    color: white;
    font-family: 'Roboto', sans-serif;
  }

  .results {
    position: relative;
  }

  #result {
    bottom: 0;
    font-size: 48px;
    padding-right: 20px;
    position: absolute;
    right: 0;
  }
</pre>

<h3 id="javascript">JavaScript</h3>

<p>Markup defines the structure of the application, CSS gives the looks and JavaScript is the functionality. The best thing about JS is it’s flexibility. It’s a weakly typed language that can be used to write code in whatever programming style you like, be it Object Oriented, be it functional, be it procedural. But when you are working on a project, it’s always good to define a set of rules and always follow these rules through out the development. These rules could be about syntax, the <a href="https://en.wikipedia.org/wiki/Programming_paradigm">paradigm</a> of choice or even could be about variableNamings.</p>

<p>Our objectives for this project are:</p>

<ol>
  <li>Immutable calculator state</li>
  <li>Always display results using calculator state</li>
  <li>Try to follow functional programming, as much as possible</li>
  <li>Not more than two levels of nested logic in a function</li>
</ol>

<p>Why should we keep the application state immutable, why should we keep state in the first place? Basically, in mostly all the modern frameworks and large applications, you have to keep the state. In these scenarios, it a healthy idea to see your application as a set of components that operate on and display the application’s state. Different libraries have different approaches for manipulating state, some, such as Redux keep a single state object and keeps it immutable. No action would partially modify the application state. We hope this could be a used as a light introduction to such philosophies.</p>

<p>Our calculator state is generated with the function</p>
<pre class="prettyprint">
  function generateState(operation, numA, numB, result) {
    var newState = {
      numA: numA || 0,
      numB: numB || 0,
      operation: operation,
      result: result
    };
    return newState;
  }
</pre>

<p>numA is the first number, numB is the second number, operation holds the operator and result will be stored in result. All these details can be set as params. If no details are given, a default state is generated.</p>

<p>Simply put, what we are doing is add an event listener to the calculator block. This is a form of <a href="https://davidwalsh.name/event-delegate">event deligation</a>, the process of delegating a parent block to handle click events of all it’s child elements. <code class="highlighter-rouge">calculator.addEventListener('click', handleClick);</code>. Then inside <code class="highlighter-rouge">handleClick</code>, we would find out what element triggered this event and extract what action is to be performed, with the help of data-attributes<code class="highlighter-rouge">var action = target.getAttribute('data-action');</code>.</p>

<p>With the help of an <code class="highlighter-rouge">evaluate</code> function, we generate a new caclculator state. And print that result using <code class="highlighter-rouge">printResult</code>. Evaluate checks the action and selects appropriate action. If the clicked button is a number, it will <code class="highlighter-rouge">setNumber</code>, if it’s an operator- <code class="highlighter-rouge">setOperator</code>, if assign operator- <code class="highlighter-rouge">calculate</code>. If the click is on some random part of the board, just clone the state.</p>

<p><code class="highlighter-rouge">setNumber</code> adds number to state. If operator is present the number will be saved as numB, otherwise, it will be saved as numA. <code class="highlighter-rouge">setOperator</code> sets the operator. <code class="highlighter-rouge">calculate</code> takes the state and calculates the result, sets result as numA and numB as zero.</p>

<p>The function <code class="highlighter-rouge">beautify</code> takes a string and cleans it up to be able to display as result.</p>

<p>Something different that you might be able to observe is that to clone a state, we write <code class="highlighter-rouge">return generateState(state.operator, state.numA, state.numB, state.result);</code>. why didn’t we go with <code class="highlighter-rouge">return state;</code>. In JS, all objects are reffered with their variable name. So if we assign an object as a new variable, we are actually working with the same object.</p>

<pre class="prettyprint">
  var a = {k: 123};
  var b = a;
  b.k = 333;
  console.log(a.k); // prints 333, because a and b refers to same object in memeory
  
  var a = 9; // assign a as primitive number 9
  var b = a;
  a = 10;
  console.log(a, b); // prints 10, 9; since a and b are assigned with primitives, they are not just references
</pre>

<p>If we go with <code class="highlighter-rouge">generateState</code>, it won’t assign the object, it would just assign each key such as operator, numA etc with a new JavaScript primitive.</p>

<p>Read more about JS object cloning <a href="http://blog.soulserv.net/understanding-object-cloning-in-javascript-part-i/">here</a>.</p>

<p>Here’s our app.js file:</p>
<pre class="prettyprint">
  // to generate state
  function generateState(operation, numA, numB, result) {
    var newState = {
      numA: numA || 0,
      numB: numB || 0,
      operation: operation,
      result: result
    };
    return newState;
  }

  // To add new number to calculator state
  function setNumber(state, newValue) {
    if (state.operation == null) {
      return generateState(state.operation, state.numA += newValue, state.numB, state.result);
    } else { // if operator is present, set as numB
      return generateState(state.operation, state.numA, state.numB += newValue, state.result);
    }
  }

  // To set an operator
  function setOperator(state, newValue) {
    if (newValue == 'c') { // if operator is clear, reset state
      return generateState();
    }
    return generateState(newValue, state.numA, state.numB, state.result);
  }

  // Generate result
  function calculate(state, newValue) {
    var numA = parseInt(state.numA);
    var numB = parseInt(state.numB);
    var operation = state.operation;
    var result;
    if (numA == NaN || numB == NaN) {
      return generateState(null, null, null, 'Invalid');
    }
    switch (operation) {
      case '+':
        result = numA + numB;
        break;
      case '-':
        result = numA - numB;
        break;
      case '*':
        result = numA * numB;
        break;
      case '/':
        result = numA / numB;
        break;
      default:
        result = null;
    }
    return generateState(null, result, null, result);
  }

  function evaluate(state, newAction, newValue) {
    switch (newAction) {
      case 'number':
        return setNumber(state, newValue);
      case 'operation':
        return setOperator(state, newValue);
      case 'calculate':
        return calculate(state, newValue);
      default: // click is elsewhere on the board
        return generateState(state.operator, state.numA, state.numB, state.result);
    }
  }

  function beautify(num) {
    var n = num
    if (n == undefined || n == NaN) {
      return 0;
    }
    return parseInt(num);
  }

  function printResult(state) {
    elemA.innerHTML = parseInt(state.numA);

    // To avoid showing numB as zero
    var numB = parseInt(state.numB);
    if (!numB) {
      numB = null;
    }
    elemB.innerHTML = numB;
    elemOperator.innerHTML = state.operation || null;
    elemResult.innerHTML = beautify(state.result);
  }

  function handleClick(event) {
    var target = event.target;
    var action = target.getAttribute('data-action');
    var value = target.getAttribute('data-value');
    calculatorState = evaluate(calculatorState, action, value);
    printResult(calculatorState);
  }

  var calculator = document.getElementById('calc');
  var elemA = document.getElementById('num-a');
  var elemB = document.getElementById('num-b');
  var elemOperator = document.getElementById('operator');
  var elemResult = document.getElementById('result');
  var calculatorState = generateState();

  calculator.addEventListener('click', handleClick);
</pre>

<p>Hope this have introduced a few new things to your coding skills :)</p>

<h3 id="improvements">Improvements</h3>

<p>The improvements that can be implemented to the calculator project:</p>

<ol>
  <li>Add keyboard bindings</li>
  <li>Tweak style of equals button as in dribble</li>
  <li>Try adding new operators</li>
  <li>Add an undo button</li>
</ol>

<p>Project &amp; Tutorial by <a href="https://github.com/sravan-s">Sravan S</a></p>

</div>


	<script src="/js/editor.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.js"></script>
<script type="text/javascript"> 
   NProgress.configure({ 
   	showSpinner: true
    });
   NProgress.start();   
   NProgress.done();
</script>



	</body>
</html>